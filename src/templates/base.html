<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{{ title }} - Hybrid Agent</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 0; transition: background-color 0.3s, color 0.3s; }
        .container { max-width: 960px; margin: auto; padding: 20px; }
        .dark-mode { background-color: #333; color: #f4f4f4; }
        nav { background: #eee; padding: 10px 20px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; }
        .dark-mode nav { background: #222; }
        .alert { padding: 15px; margin-bottom: 20px; border: 1px solid transparent; border-radius: 4px; }
        .alert-success { color: #3c763d; background-color: #dff0d8; border-color: #d6e9c6; }
        .alert-danger { color: #a94442; background-color: #f2dede; border-color: #ebccd1; }
        .alert-info { color: #31708f; background-color: #d9edf7; border-color: #bce8f1; }
        .alert-warning { color: #8a6d3b; background-color: #fcf8e3; border-color: #faebcc; }
    </style>
</head>
<body class="{{ 'dark-mode' if theme == 'dark' else '' }}">
    <nav>
        <div>
            <a href="{{ url_for('main.telegram_page') }}">Telegram Tool</a>
            <a href="{{ url_for('billing.pricing') }}">Pricing</a>
            {% if current_user.is_authenticated and current_user.is_admin %}
                <a href="{{ url_for('admin.index') }}">Admin</a>
            {% endif %}
        </div>
        <div>
            <a href="#" onclick="toggleTheme()">Toggle Theme</a>
            {% if current_user.is_authenticated %}
            <a href="{{ url_for('profile.profile') }}">Profile</a>
            <a href="{{ url_for('billing.billing_portal') }}">Billing</a>
            <a href="{{ url_for('auth.logout') }}">Logout</a>
            {% else %}
            <a href="{{ url_for('auth.login') }}">Login</a>
            <a href="{{ url_for('auth.register') }}">Register</a>
            {% endif %}
        </div>
    </nav>
    <main role="main" class="container">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="alert alert-{{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </main>
    <script>
        function toggleTheme() {
            let theme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
            document.cookie = `theme=${theme};path=/;max-age=31536000`;
            document.body.classList.toggle('dark-mode');
        }
    </script>
</body>
</html>
